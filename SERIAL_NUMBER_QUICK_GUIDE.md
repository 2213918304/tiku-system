# 题目序号功能 - 快速使用指南

## 🎯 核心功能

**每个章节的题目独立编号，自动接续！**

## 📝 使用示例

### 场景：第一章已有4题，现在要导入新题

**第一章当前状态：**
```
1. 题目A
2. 题目B  
3. 题目C
4. 题目D
```

**导入3道新题后：**
```
1. 题目A
2. 题目B  
3. 题目C
4. 题目D
5. 新题目1  ← 自动接续
6. 新题目2  ← 自动接续
7. 新题目3  ← 自动接续
```

### 场景：删除题目后再导入

**第二章删除前：**
```
1. 题目A
2. 题目B  
3. 题目C
```

**删除题目B后：**
```
1. 题目A
3. 题目C  ← 序号保持不变
```

**导入2道新题后：**
```
1. 题目A
3. 题目C
4. 新题目1  ← 从最大序号3接续
5. 新题目2  ← 继续递增
```

## 🚀 如何使用

### 1. 重启后端服务
修改了代码，需要重启才能生效。

### 2. 导入题目
- **智能导入模式**：自动识别章节并分配序号
- **按章节导入模式**：先选择章节，导入时自动分配序号

### 3. 查看效果
访问题库浏览页面，每个章节的题目都从1开始编号！

## 💡 关键特性

### ✅ 自动计算
- 读取章节最后一题的序号
- 新题目自动 +1
- 无需手动设置

### ✅ 独立编号
- 每个章节独立计数
- 第一章：1, 2, 3...
- 第二章：1, 2, 3...
- 互不影响

### ✅ 删除友好
- 删除题目不影响其他题目序号
- 新导入的题目自动接续最大序号
- 避免序号冲突

## 📊 显示效果

```
📖 第一章 绪论
  1. 根据《辽宁师范大学学生管理规定》...
  2. 学校制定学生违纪处分的具体办法...
  3. 同学小明是大一新生...

📖 第二章 唯物辩证法  
  1. 唯物辩证法认为...
  2. 质量互变规律...
  3. 矛盾的普遍性...
```

## ⚠️ 注意事项

1. **必须重启后端服务**才能生效
2. 旧数据的序号为空，按ID排序
3. 新导入的数据会自动分配序号
4. 删除题目会留下序号空缺（这是正常的）

## 🔧 技术实现

### 数据库变化
添加了 `serial_number` 字段到 `question` 表：
```sql
ALTER TABLE question ADD COLUMN serial_number INT;
```

### 自动计算逻辑
```java
// 获取章节最大序号
Integer maxSerialNumber = findMaxSerialNumberByChapterId(chapterId);
// 新题序号 = 最大序号 + 1（如果没有则从1开始）
serialNumber = (maxSerialNumber != null ? maxSerialNumber + 1 : 1);
```

### 排序规则
```java
// 优先按序号排序，序号相同或为空时按ID排序
ORDER BY serial_number ASC, id ASC
```

## 🎉 立即测试

1. ✅ 重启后端服务
2. ✅ 导入题目到第一章（会自动分配序号1, 2, 3...）
3. ✅ 导入题目到第二章（会自动分配序号1, 2, 3...）
4. ✅ 访问 http://localhost:5173/subjects 查看效果
5. ✅ 每个章节都从1开始编号！

**现在就可以试试导入题目了！**




